block spawn
{
	es_give event_var(userid) weapon_mp9
	es_playsound event_var(userid) ambient/materials/metal4.wav .6
	es_getplayerlocation wcs_x1 wcs_y1 wcs_z1 event_var(userid)
	es_xmath wcs_z1 + 10
	es est_effect 10 #a 0 sprites/lgtning.vmt server_var(wcs_x1) server_var(wcs_y1) server_var(wcs_z1) 330 331 3 60 10 0 100 100 255 200 5
	es_xmath wcs_z1 + 20
	es est_effect 10 #a 0 sprites/lgtning.vmt server_var(wcs_x1) server_var(wcs_y1) server_var(wcs_z1) 75 300 3 60 10 0 100 100 255 200 5
}

block speed
{
	es wcs_setfx speed event_var(userid) = server_var(wcs_speed) 0
	es_xmath wcs_speed * 100
	es_xmath wcs_speed - 100
	es_tell event_var(userid) #multi #green [WCS]: #lightgreen Arctic environment - Allows you to run server_var(wcs_speed)% faster
}

block leech
{
	if (server_var(wcs_dice) <= server_var(wcs_chance)) do
	{
		if (event_var(es_userdead) = 0) do
		{
			if (event_var(es_attackerdead) = 0) do 
			{
				es_getplayerlocation wcs_x1 wcs_y1 wcs_z1 event_var(userid)
				es_getplayerlocation wcs_x2 wcs_y2 wcs_z2 event_var(attacker)
				es_xmath wcs_z1 + 20
				es_xmath wcs_z2 + 20
				es_createvectorstring vector1 server_var(wcs_x1) server_var(wcs_y1) server_var(wcs_z1)
				es_createvectorstring vector2 server_var(wcs_x2) server_var(wcs_y2) server_var(wcs_z2)
				es est_effect_06 #a 0 sprites/lgtning.vmt server_var(vector2) server_var(vector1) 5 1 15 15 0 0 100 100 230 255 15
				es est_effect_06 #a 0 effects/blueflare1.vmt server_var(vector2) server_var(vector1) 5 1 30 30 0 0 200 200 200 255 20
				es est_effect 10 #a 0 sprites/lgtning.vmt server_var(wcs_x1) server_var(wcs_y1) server_var(wcs_z1) 155 65 1 70 10 0 60 60 255 255 15
				es est_effect 10 #a 0 sprites/blueflare1.vmt server_var(wcs_x1) server_var(wcs_y1) server_var(wcs_z1) 155 65 1 20 10 0 100 100 200 255 20
				es playerget health wcs_tmp2 event_var(attacker)
				if (server_var(wcs_tmp2) < 200) do
				{
					es_xrand wcs_addhealth 12 20
					es wcs_setfx health event_var(attacker) + server_var(wcs_addhealth) 0
					es_centertell event_var(attacker) Leeched server_var(wcs_addhealth) health!
				}
				if (server_var(wcs_tmp2) => 200) do
				{
					es wcs_setfx health event_var(attacker) = 200 0
					es_centertell event_var(attacker) You have reached the 200 health cap!
				}
			}
		}
	}
}

block invis
{
	es wcs_color event_var(userid) 255 255 255 server_var(wcs_invis) 0
	es_tell event_var(userid) #multi #green [WCS]: #lightgreen Pure ice - Made you less visible
}

block damage
{
	es_xrand wcs_dmg 4 13
	es playsound event_var(userid) wcs\icytouch.wav 1
	es playsound event_var(attacker) wcs\icytouch.wav .4
	es wcs_dealdamage event_var(userid) event_var(attacker) server_var(wcs_dmg)
	es_centertell event_var(attacker) Penetrating ice shards did + server_var(wcs_dmg) damage!
	es_centertell event_var(userid) Took + server_var(wcs_dmg) from some penetrating ice shards!		
	es_getplayerlocation wcs_x1 wcs_y1 wcs_z1 event_var(attacker)
	es_getplayerlocation wcs_x2 wcs_y2 wcs_z2 event_var(userid)
	es_xmath wcs_z1 + 25
	es_xmath wcs_z2 + 25
	es_xmath wcs_x2 + 25
	es_createvectorstring vector1 server_var(wcs_x1) server_var(wcs_y1) server_var(wcs_z1)
	es_createvectorstring vector2 server_var(wcs_x2) server_var(wcs_y2) server_var(wcs_z2)
	es est_effect_06 #a 0 sprites/lgtning.vmt server_var(vector1) server_var(vector2) 1 .5 8 8 0 0 100 100 255 255 20
	es_xmath wcs_x2 - 50
	es_createvectorstring vector2 server_var(wcs_x2) server_var(wcs_y2) server_var(wcs_z2)
	es est_effect_06 #a 0 sprites/lgtning.vmt server_var(vector1) server_var(vector2) 1 .5 8 8 0 0 100 100 255 255 20
	es est_effect_08 #a 0 sprites/lgtning.vmt server_var(vector2) 100 375 1 0.5 75 10 .4 100 100 255 255 2 1
}

block breeze
{
        es_xset wcs_targetteam 0
        es_xset wcs_team_target 0
        es_xset wcs_pcount 0
        es_xset wcs_targetid 0
        es_xset wcs_counter 0
		es_xset wcs_maxtargets 10

        es_getplayerteam wcs_team server_var(wcs_userid)
        if (server_var(wcs_team) = 2) do
        {
                es_xset wcs_targetteam #ct
                es_xset wcs_team_target 3
        }
        if (server_var(wcs_team) = 3) do
        {
                es_xset wcs_targetteam #t
                es_xset wcs_team_target 2
        }
        if (server_var(wcs_targetteam) != 0) do
        {
                es_getlivingplayercount wcs_pcount server_var(wcs_team_target)
                if (server_var(wcs_pcount) > 0) do
                {
						es playerget viewcoord server_var(wcs_userid) wcs_x1 wcs_y1 wcs_z1
						es wcs_nearcoord wcs_targetid server_var(wcs_targetteam) server_var(wcs_x1) server_var(wcs_y1) server_var(wcs_z1) server_var(wcs_range) "es_exists ex userid server_var(wcs_targetid);if (server_var(ex) = 1) then es_xdoblock wcs/tools/trixie/frost_demon/coldbreeze"
                        if (server_var(wcs_counter) > 0) do
                        {
								es_tell server_var(wcs_userid) #multi #green [WCS]: #lightgreen Cold breeze affected server_var(wcs_counter) people
                        }
                        else do
                        {
                                es_xset wcs_ultinotexec 1
                        }
                }
                else do
                {
                        es_xset wcs_ultinotexec 1
                }
        }
        else do
        {
                es_xset wcs_ultinotexec 1
        }
        if (server_var(wcs_ultinotexec) = 1) then es_tell server_var(wcs_userid) #multi #green [WCS]: #lightgreen Cold breeze - Failed
        if (server_var(wcs_ultinotexec) = 1) then wcs_cancelulti server_var(wcs_userid)
}

block coldbreeze
{
	es_xmath wcs_counter + 1
	if (server_var(wcs_counter) < server_var(wcs_maxtargets)) do
	{
		es wcs_getwallbetween wcs_wall server_var(wcs_userid) server_var(wcs_targetid)
		if (server_var(wcs_wall) != 1)
		{
			es wcsgroup get ulti_immunity wcs_tmp server_var(wcs_targetid)
			if (server_var(wcs_tmp) != 1) do
			{
				es_centertell server_var(wcs_userid) You've summoned a cold breeze!
				es_centertell server_var(wcs_targetid) You were caught in a cold breeze
				es playsound server_var(wcs_userid) ambient\levels\canals\windmill_wind_loop1.wav 1.0
				es playsound server_var(wcs_targetid) ambient\levels\canals\windmill_wind_loop1.wav 1.0
				es wcs_setfx speed server_var(wcs_targetid) = 0.8 2
				es_tell server_var(wcs_targetid) #multi #green [WCS]: #lightgreen Cold breeze - Slowed you down for 2 seconds
				es playerget viewcoord server_var(wcs_userid) wcs_x1 wcs_y1 wcs_z1
				es_xmath wcs_z1 + 10
				es est_effect 10 #a 0 sprites/cbbl_smoke.vmt server_var(wcs_x1) server_var(wcs_y1) server_var(wcs_z1) 300 301 2 60 10 0 100 100 255 200 5
				es_xmath wcs_z1 + 25
				es est_effect 10 #a 0 sprites/cbbl_smoke.vmt server_var(wcs_x1) server_var(wcs_y1) server_var(wcs_z1) 75 280 2 60 10 0 100 100 255 200 5
			}
		}
	}
}
